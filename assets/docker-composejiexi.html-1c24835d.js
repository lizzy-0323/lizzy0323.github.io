import { _ as _export_sfc, o as openBlock, c as createElementBlock, e as createStaticVNode } from "./app-657f6655.js";
const _sfc_main = {};
function _sfc_render(_ctx, _cache) {
  return openBlock(), createElementBlock("div", null, _cache[0] || (_cache[0] = [
    createStaticVNode('<h1 id="docker-compose解析" tabindex="-1"><a class="header-anchor" href="#docker-compose解析" aria-hidden="true">#</a> Docker-compose解析</h1><h2 id="docker-compose-是什么" tabindex="-1"><a class="header-anchor" href="#docker-compose-是什么" aria-hidden="true">#</a> Docker-compose 是什么？</h2><p>官方定义：Docker Compose 是一个工具，允许通过一个单独的 YAML 文件定义和管理多个 Docker 容器的配置。它简化了多个容器应用的配置过程，允许用户定义整个应用程序的服务、网络、卷等。</p><h2 id="什么场景要用-docker-compose" tabindex="-1"><a class="header-anchor" href="#什么场景要用-docker-compose" aria-hidden="true">#</a> 什么场景要用 docker-compose？</h2><p>一个工具的使用一定有相应的场景，否则它就没有价值。 docker-compose的使用场景是：当我们需要启动多个容器，来完成我们的服务，比如一个后端服务器，一个 redis，一个 mysql，以此类推，而有些容器的启动需要依赖其他容器，这部分可以在 docker-compose 中非常容易的实现，而不需要每次都编写脚本，按照一系列命令来启动容器。</p><p>请参考我目前项目中的一个Docker compose 的配置文件，如下所示：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#39;3.7&#39;</span>\n\n<span class="token key atrule">services</span><span class="token punctuation">:</span>\n  <span class="token key atrule">redis</span><span class="token punctuation">:</span>\n    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis\n    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped\n    <span class="token key atrule">expose</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> <span class="token number">6379</span>\n    <span class="token key atrule">networks</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> autograph<span class="token punctuation">-</span>network\n    \n  <span class="token key atrule">mongodb</span><span class="token punctuation">:</span>\n    <span class="token key atrule">image</span><span class="token punctuation">:</span> mongo<span class="token punctuation">:</span><span class="token number">5</span>\n    <span class="token key atrule">environment</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> MONGO_INITDB_ROOT_USERNAME=mongo\n      <span class="token punctuation">-</span> MONGO_INITDB_ROOT_PASSWORD=12345\n    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> mongodbdata<span class="token punctuation">:</span>/data/db\n    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped\n    <span class="token key atrule">expose</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> <span class="token number">27017</span>\n    <span class="token key atrule">ports</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> <span class="token string">&quot;127.0.0.1:27017:27017&quot;</span>\n    <span class="token key atrule">networks</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> autograph<span class="token punctuation">-</span>network\n    <span class="token comment"># quiet</span>\n    <span class="token key atrule">logging</span><span class="token punctuation">:</span>\n      <span class="token key atrule">driver</span><span class="token punctuation">:</span> <span class="token string">&quot;none&quot;</span>\n    \n  <span class="token key atrule">celery</span><span class="token punctuation">:</span>\n    <span class="token key atrule">build</span><span class="token punctuation">:</span> .\n    <span class="token key atrule">init</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># fix zombie processes</span>\n    <span class="token key atrule">command</span><span class="token punctuation">:</span> xvfb<span class="token punctuation">-</span>run celery <span class="token punctuation">-</span>A tasks worker <span class="token punctuation">-</span>l INFO <span class="token punctuation">-</span><span class="token punctuation">-</span>concurrency=2\n    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> mongodb\n      <span class="token punctuation">-</span> redis\n    <span class="token key atrule">mem_limit</span><span class="token punctuation">:</span> 6g\n    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped\n    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> ./<span class="token punctuation">:</span>/opt/autograph<span class="token punctuation">:</span>ro\n    <span class="token key atrule">deploy</span><span class="token punctuation">:</span>\n      <span class="token key atrule">mode</span><span class="token punctuation">:</span> replicated\n      <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>\n    <span class="token key atrule">user</span><span class="token punctuation">:</span> 1000<span class="token punctuation">:</span><span class="token number">1000</span>\n    <span class="token key atrule">security_opt</span><span class="token punctuation">:</span>\n      <span class="token comment"># - seccomp=playwright_seccomp.json # wait until this is fixed in docker compose</span>\n      <span class="token punctuation">-</span> seccomp=unconfined\n    <span class="token key atrule">networks</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> autograph<span class="token punctuation">-</span>network\n    <span class="token key atrule">environment</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> PYTHONUNBUFFERED=1\n       \n  <span class="token key atrule">backend</span><span class="token punctuation">:</span>\n    <span class="token key atrule">build</span><span class="token punctuation">:</span> .\n    <span class="token key atrule">env_file</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> .env\n    <span class="token key atrule">command</span><span class="token punctuation">:</span> gunicorn app<span class="token punctuation">:</span>app <span class="token punctuation">-</span><span class="token punctuation">-</span>bind 0.0.0.0<span class="token punctuation">:</span>9876 <span class="token punctuation">-</span><span class="token punctuation">-</span>workers=8 <span class="token punctuation">-</span><span class="token punctuation">-</span>log<span class="token punctuation">-</span>level=info <span class="token punctuation">-</span><span class="token punctuation">-</span>timeout 300 <span class="token punctuation">-</span><span class="token punctuation">-</span>access<span class="token punctuation">-</span>logfile &#39;<span class="token punctuation">-</span>&#39; <span class="token punctuation">-</span><span class="token punctuation">-</span>reload\n    <span class="token key atrule">mem_limit</span><span class="token punctuation">:</span> 8g\n    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped\n    <span class="token key atrule">user</span><span class="token punctuation">:</span> 1000<span class="token punctuation">:</span><span class="token number">1000</span>\n    <span class="token key atrule">expose</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> <span class="token number">9876</span>\n    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> ./<span class="token punctuation">:</span>/opt/autograph<span class="token punctuation">:</span>ro\n    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> celery\n    <span class="token key atrule">networks</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> autograph<span class="token punctuation">-</span>network\n    <span class="token key atrule">environment</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> PYTHONUNBUFFERED=1\n\n\n  <span class="token key atrule">flower</span><span class="token punctuation">:</span>\n    <span class="token key atrule">image</span><span class="token punctuation">:</span> mher/flower\n    <span class="token key atrule">environment</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> CELERY_BROKER_URL=redis<span class="token punctuation">:</span>//redis<span class="token punctuation">:</span>6379/0\n      <span class="token punctuation">-</span> FLOWER_PORT=5555\n    <span class="token key atrule">ports</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> 0.0.0.0<span class="token punctuation">:</span>5555<span class="token punctuation">:</span><span class="token number">5555</span>\n    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped\n    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> redis\n      <span class="token punctuation">-</span> celery\n    <span class="token key atrule">networks</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> autograph<span class="token punctuation">-</span>network\n\n\n  <span class="token key atrule">nginx</span><span class="token punctuation">:</span>\n    <span class="token key atrule">build</span><span class="token punctuation">:</span>\n      <span class="token key atrule">context</span><span class="token punctuation">:</span> ./proxy\n      <span class="token key atrule">args</span><span class="token punctuation">:</span>\n          <span class="token punctuation">-</span> FRONTEND_USERNAME=$<span class="token punctuation">{</span>FRONTEND_USERNAME<span class="token punctuation">}</span>\n          <span class="token punctuation">-</span> FRONTEND_PASSWORD=$<span class="token punctuation">{</span>FRONTEND_PASSWORD<span class="token punctuation">}</span>\n          <span class="token punctuation">-</span> BASEDOMAIN=$<span class="token punctuation">{</span>BASEDOMAIN<span class="token punctuation">}</span>\n          <span class="token punctuation">-</span> CROSSORIGINDOMAIN=$<span class="token punctuation">{</span>CROSSORIGINDOMAIN<span class="token punctuation">}</span>\n    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped\n    <span class="token key atrule">env_file</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> .env\n    <span class="token key atrule">ports</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> 0.0.0.0<span class="token punctuation">:</span><span class="token datetime number">80:80</span>\n      <span class="token punctuation">-</span> 0.0.0.0<span class="token punctuation">:</span>443<span class="token punctuation">:</span><span class="token number">443</span>\n    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> backend\n    <span class="token key atrule">networks</span><span class="token punctuation">:</span>\n      <span class="token key atrule">autograph-network</span><span class="token punctuation">:</span>\n        <span class="token comment"># set aliases to the needed domains, so that the celery workers find them witouth external dns. This way, traffix stays on-host.</span>\n        <span class="token key atrule">aliases</span><span class="token punctuation">:</span>\n          <span class="token punctuation">-</span> $<span class="token punctuation">{</span>BASEDOMAIN<span class="token punctuation">}</span>\n          <span class="token punctuation">-</span> $<span class="token punctuation">{</span>CROSSORIGINDOMAIN<span class="token punctuation">}</span>\n\n    \n<span class="token comment">##################################################################################################################</span>\n<span class="token comment">##### Volumes &amp; Networks</span>\n<span class="token comment">##################################################################################################################</span>\n\n<span class="token key atrule">volumes</span><span class="token punctuation">:</span>\n  <span class="token key atrule">mongodbdata</span><span class="token punctuation">:</span>\n\n<span class="token key atrule">networks</span><span class="token punctuation">:</span>\n  <span class="token key atrule">autograph-network</span><span class="token punctuation">:</span>\n    <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge\n    <span class="token key atrule">enable_ipv6</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>\n    <span class="token key atrule">internal</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># allow outgoing internet access</span>\n    <span class="token key atrule">ipam</span><span class="token punctuation">:</span>\n      <span class="token key atrule">driver</span><span class="token punctuation">:</span> default\n      <span class="token key atrule">config</span><span class="token punctuation">:</span>\n        <span class="token punctuation">-</span> <span class="token key atrule">subnet</span><span class="token punctuation">:</span> 10.173.202.186/16\n          <span class="token key atrule">gateway</span><span class="token punctuation">:</span> 10.173.202.1\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对上面的描述字段进行解析： <code>version</code>: 指的是 docker-compose 的版本 <code>service</code> : 指的是要运行的服务 <code>flower,redis,mongodb</code>: 都是我们的容器 <code>networks</code> ：网络配置 上面的例子中，我们可以看到，有一些容器有 image 字段，有一些则是 build，这是因为，有一些容器可以直接从 dockerhub 等镜像库来构建镜像，有一些则从当前目录开始寻找 dockerfile 文件，例如 <code>build .</code> 就从当前的目录下寻找 dockerfile 文件来构建容器。</p><h3 id="docker-compose-yaml与dockerfile的联系" tabindex="-1"><a class="header-anchor" href="#docker-compose-yaml与dockerfile的联系" aria-hidden="true">#</a> docker-compose.yaml与dockerfile的联系：</h3><ul><li><code>dockerfile</code>就是构建镜像的一个描述文件，它写了具体进行的一系列操作和需要的软件包，</li><li><code>docker-compose.yaml</code>则是在容器的角度，主要描述了如何编排容器，docker-compose中描述的容器，可以用dockerfile来构建，也可以用docker-hub上现成的镜像</li></ul><h2 id="docker-compose-使用命令" tabindex="-1"><a class="header-anchor" href="#docker-compose-使用命令" aria-hidden="true">#</a> Docker-compose 使用命令</h2><ul><li>构建命令： <code>docker compose build</code></li><li>运行命令： <code>docker compose up </code>(一般用 docker compose up -d，<strong>参数的含义是后台构建，否则每个容器都会交替打印输出在控制台，非常不利于观看</strong>)</li><li>查看当前容器列表：<code>docker compose ps</code></li></ul><h2 id="docker-compose-的优点和不足" tabindex="-1"><a class="header-anchor" href="#docker-compose-的优点和不足" aria-hidden="true">#</a> Docker-compose 的优点和不足</h2><p>Docker-compose 是一个由 docker 官方出品的容器编排工具，简化了容器化应用程序的部署和管理过程，它的核心概念包括：服务（Service）、网络（network）、和卷（volume），因此比较好的一点是它易于上手，并且有 docker 社区支持。 但是如果要增加容器，还是要修改 docker-compose 文件，且它并不支持负载均衡等策略。 基于以上描述我想说的已经很明白了：</p><ul><li>如果需要在工作场景中搭建集群，或者编排多个容器，Google 出品的k 8 s 可能是更好的选择，当然也更为复杂（有一些更上层的抽象概念）</li><li>docker-compose 由于操作简单，更适用于单机跑多容器的场景，也更易于部署。 <em>实际上 docker 官方也出过类似 k8s 的工具，只不过没有 k8s 热度高</em></li></ul>', 15)
  ]));
}
const dockerComposejiexi_html = /* @__PURE__ */ _export_sfc(_sfc_main, [["render", _sfc_render], ["__file", "docker-composejiexi.html.vue"]]);
export {
  dockerComposejiexi_html as default
};
